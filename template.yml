# This AWS SAM template has been generated from your function's configuration. If
# your function has one or more triggers, note that the AWS resources associated
# with these triggers aren't fully specified in this template and include
# placeholder values. Open this template in AWS Infrastructure Composer or your
# favorite IDE and modify it to specify a serverless application with other AWS
# resources.
AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: An AWS Serverless Application Model template describing your function.
Resources:
  amazonConnectOperationalReviewauto:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: ./src
      Description: ''
      MemorySize: 128
      Timeout: 600
      Handler: lambda_function.lambda_handler
      Runtime: python3.13
      Architectures:
        - x86_64
      EphemeralStorage:
        Size: 512
      Environment:
        Variables:
          CONNECT_INSTANCE_ARN: >-
            arn:aws:connect:us-east-1:926389207561:instance/a5e39fd7-96ce-4d4b-8460-20f0d1dffc5e
      EventInvokeConfig:
        MaximumEventAgeInSeconds: 21600
        MaximumRetryAttempts: 2
      PackageType: Zip
      Policies:
        - Statement:
            - Sid: VisualEditor0
              Effect: Allow
              Action:
                - mobiletargeting:PhoneNumberValidate
              Resource: '*'
            - Sid: VisualEditor0
              Effect: Allow
              Action:
                - s3:PutObject
              Resource: arn:aws:s3:::amazonconnectoperationalreview*/*
            - Sid: CloudWatchReadOnlyAccessPermissions
              Effect: Allow
              Action:
                - application-autoscaling:DescribeScalingPolicies
                - application-signals:BatchGet*
                - application-signals:Get*
                - application-signals:List*
                - autoscaling:Describe*
                - cloudtrail:ListChannels
                - cloudwatch:BatchGet*
                - cloudwatch:Describe*
                - cloudwatch:GenerateQuery
                - cloudwatch:Get*
                - cloudwatch:List*
                - logs:Get*
                - logs:List*
                - logs:StartQuery
                - logs:StopQuery
                - logs:Describe*
                - logs:TestMetricFilter
                - logs:FilterLogEvents
                - logs:StartLiveTail
                - logs:StopLiveTail
                - oam:ListSinks
                - observabilityadmin:GetCentralizationRuleForOrganization
                - observabilityadmin:ListCentralizationRulesForOrganization
                - observabilityadmin:GetTelemetryEvaluationStatus
                - observabilityadmin:GetTelemetryEvaluationStatusForOrganization
                - observabilityadmin:GetTelemetryRule
                - observabilityadmin:GetTelemetryRuleForOrganization
                - observabilityadmin:ListResourceTelemetry
                - observabilityadmin:ListResourceTelemetryForOrganization
                - observabilityadmin:ListTelemetryRules
                - observabilityadmin:ListTelemetryRulesForOrganization
                - observabilityadmin:GetTelemetryEnrichmentStatus
                - observabilityadmin:ListTagsForResource
                - sns:Get*
                - sns:List*
                - rum:BatchGet*
                - rum:Get*
                - rum:List*
                - synthetics:Describe*
                - synthetics:Get*
                - synthetics:List*
                - xray:BatchGet*
                - xray:Get*
                - xray:List*
                - xray:StartTraceRetrieval
                - xray:CancelTraceRetrieval
              Resource: '*'
            - Sid: OAMReadPermissions
              Effect: Allow
              Action:
                - oam:ListAttachedLinks
              Resource: arn:aws:oam:*:*:sink/*
            - Sid: CloudWatchReadOnlyGetRolePermissions
              Effect: Allow
              Action:
                - iam:GetRole
              Resource: >-
                arn:aws:iam::*:role/aws-service-role/application-signals.cloudwatch.amazonaws.com/AWSServiceRoleForCloudWatchApplicationSignals
            - Sid: CloudWatchCloudTrailPermissions
              Effect: Allow
              Action:
                - cloudtrail:GetChannel
              Resource: >-
                arn:aws:cloudtrail:*:*:channel/aws-service-channel/application-signals/*
            - Sid: CloudWatchServiceQuotaPermissions
              Effect: Allow
              Action:
                - servicequotas:GetServiceQuota
              Resource:
                - arn:aws:servicequotas:*:*:s3/*
                - arn:aws:servicequotas:*:*:dynamodb/*
                - arn:aws:servicequotas:*:*:kinesis/*
                - arn:aws:servicequotas:*:*:sns/*
                - arn:aws:servicequotas:*:*:bedrock/*
                - arn:aws:servicequotas:*:*:lambda/*
                - arn:aws:servicequotas:*:*:fargate/*
                - arn:aws:servicequotas:*:*:elasticloadbalancing/*
                - arn:aws:servicequotas:*:*:ec2/*
            - Effect: Allow
              Action:
                - logs:CreateLogGroup
                - logs:CreateLogStream
                - logs:PutLogEvents
              Resource: '*'
            - Sid: AllowConnectReadOnly
              Effect: Allow
              Action:
                - connect:Get*
                - connect:Describe*
                - connect:List*
                - ds:DescribeDirectories
              Resource: '*'
            - Sid: DenyConnectEmergencyAccess
              Effect: Deny
              Action:
                - connect:AdminGetEmergencyAccessToken
              Resource: '*'
            - Effect: Allow
              Action:
                - autoscaling:DescribeAccountLimits
                - cloudformation:DescribeAccountLimits
                - cloudwatch:DescribeAlarmsForMetric
                - cloudwatch:DescribeAlarms
                - cloudwatch:GetMetricData
                - cloudwatch:GetMetricStatistics
                - dynamodb:DescribeLimits
                - elasticloadbalancing:DescribeAccountLimits
                - iam:GetAccountSummary
                - kinesis:DescribeLimits
                - organizations:DescribeAccount
                - organizations:DescribeOrganization
                - organizations:ListAWSServiceAccessForOrganization
                - rds:DescribeAccountAttributes
                - route53:GetAccountLimit
                - tag:GetTagKeys
                - tag:GetTagValues
                - servicequotas:GetAssociationForServiceQuotaTemplate
                - servicequotas:GetAWSDefaultServiceQuota
                - servicequotas:GetRequestedServiceQuotaChange
                - servicequotas:GetServiceQuota
                - servicequotas:GetServiceQuotaIncreaseRequestFromTemplate
                - servicequotas:ListAWSDefaultServiceQuotas
                - servicequotas:ListRequestedServiceQuotaChangeHistory
                - servicequotas:ListRequestedServiceQuotaChangeHistoryByQuota
                - servicequotas:ListServices
                - servicequotas:ListServiceQuotas
                - servicequotas:ListServiceQuotaIncreaseRequestsInTemplate
                - servicequotas:ListTagsForResource
                - servicequotas:GetAutoManagementConfiguration
                - notifications:ListChannels
                - notifications:ListEventRules
                - notifications:ListNotificationConfigurations
                - notifications:GetNotificationConfiguration
                - notifications:GetEventRule
                - notifications:ListNotificationHubs
                - notifications-contacts:ListEmailContacts
                - notifications-contacts:GetEmailContact
                - chatbot:ListMicrosoftTeamsChannelConfigurations
                - chatbot:DescribeChimeWebhookConfigurations
                - chatbot:DescribeSlackChannelConfigurations
                - consoleapp:ListDeviceIdentities
                - consoleapp:GetDeviceIdentity
              Resource: '*'
            - Effect: Allow
              Action:
                - cloudtrail:Get*
                - cloudtrail:Describe*
                - cloudtrail:List*
                - cloudtrail:LookupEvents
              Resource: '*'
      RecursiveLoop: Terminate
      SnapStart:
        ApplyOn: None
      Tags:
        auto-delete: never
      RuntimeManagementConfig:
        UpdateRuntimeOn: Auto
